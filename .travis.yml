language: cpp
sudo: false
before_install:
#  - sudo apt-get update -qq
#  - sudo apt-get install -qq build-essential gcc llvm clang-3.4 cmake nodejs python2.7 default-jre libclosure-compiler-java
#  - wget http://launchpadlibrarian.net/151967526/emscripten_1.4.9~20130620~0ad8724-1ubuntu1_amd64.deb
#  - sudo dpkg -i "emscripten_1.4.9~20130620~0ad8724-1ubuntu1_amd64.deb"
  - clang --version
  - g++ --version
  - python --version
  - node --version
  - java -version
  - cmake
  - NUM_CORES=`cat /proc/cpuinfo | grep "^cpu cores" | uniq | cut -c 13- -`
  - echo $NUM_CORES
  - MYTEST=n
  - echo -$MYTEST "BLUB"

install:
  - wget https://s3.amazonaws.com/mozilla-games/emscripten/releases/emsdk-portable.tar.gz
  - tar -zxf emsdk-portable.tar.gz
  - rm emsdk-portable.tar.gz
  - cd emsdk_portable
  - ./emsdk update
  - ./emsdk install latest emscripten-master clang-master-64bit sdk-master-64bit
  - cd clang/fastcomp/src
  - mkdir mybuild
  - cd mybuild
  - ../configure --enable-optimized --disable-assertions --enable-targets=host,js
  - make -j${NUM_CORES}
  - ./emsdk activate latest
  - source ./emsdk_env.sh

script:
  - ls -la
  - ls -la clang/fastcomp
  - ls -la clang/fastcomp/src
  - ls -laR clang/fastcomp/build_master_64
